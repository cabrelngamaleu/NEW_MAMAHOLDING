name: Install deploy key

on:
  workflow_dispatch:

jobs:
  install-key:
    runs-on: ubuntu-latest

    steps:
      - name: Install deploy public key on server
        uses: appleboy/ssh-action@master
        with:
          host: ${{ secrets.SERVER_HOST }}
          username: ${{ secrets.SERVER_USER }}
          key: ${{ secrets.SERVER_SSH_KEY }}
          port: ${{ secrets.SERVER_SSH_PORT }}
          script: |
            set -e
            echo "Running install_deploy_key.sh on server"
            cd ~/repositories/NEW_MAMAHOLDING/mamaholding-website
            chmod +x install_deploy_key.sh || true
            bash -x ./install_deploy_key.sh
            echo "Install script finished"
